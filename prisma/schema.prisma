generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  email     String   @unique
  name      String?
  role      Role     @default(VIEWER)
  password  String
  createdAt DateTime @default(now())
}

model SpendRecord {
  id                 String   @id @default(cuid())
  date               DateTime
  cloud              String
  account_or_project String
  service            String
  team               String?
  env                String?
  cost_usd           Decimal  @db.Decimal(18, 6)
  dedupe_key         String   @unique
  createdAt          DateTime @default(now())

  @@index([date])
  @@index([cloud, date])
  @@index([service, date])
  @@index([team, date])
  @@index([env, date])
}

model SavingIdea {
  id                     String       @id @default(cuid())
  title                  String
  service                String
  est_monthly_saving_usd Decimal      @db.Decimal(18, 2)
  confidence             Float
  owner                  String
  status                 SavingStatus @default(PROPOSED)
  notes                  String?
  createdAt              DateTime     @default(now())
  updatedAt              DateTime     @updatedAt
}

enum Role {
  ADMIN
  ANALYST
  VIEWER
}

enum SavingStatus {
  PROPOSED
  APPROVED
  REALIZED
}
